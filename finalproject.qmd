---
title: "ESS 330 Final Project Results"
format: html
---


```{r}
library(tidyverse)
library(ggpubr)
library(skimr)
library(ggplot2)
library(dataRetrieval)
library(tidyverse)
library(dplyr)
library(tidymodels)
library(zoo)
library(lubridate)
library(tsibble)
library(feasts)
library(plotly)

swe_disch <- read_csv("~/github/ess-330-proj/swe_disch.csv")
```


```{r}
ggplot(swe_disch, aes(x = Q, y = swe)) +
  geom_point() +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "SWE vs. River Discharge", x = "Snow Water Equivalent (SWE)", y = "River Discharge") +
  theme_linedraw()

```



```{r}
ggplot(swe_disch, aes(x = swe, y = Q)) +
  geom_smooth() +
  labs(title = "Distribution of SWE", x = "Snow Water Equivalent", y = "Discharge") +
  theme_minimal()
```

```{r}
ggplot(swe_disch, aes(x = swe, y = Q)) +
  geom_smooth(se = FALSE, method = "lm") +
  labs(title = "SWE vs. Discharge", x = "Snow Water Equivalent", y = "Discharge") +
  theme_minimal()
```


```{r}
ggplot(swe_disch, aes(x = Q, y = swe)) +
  geom_point() +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "SWE vs. River Discharge", x = "Snow Water Equivalent (SWE)", y = "River Discharge") +
  theme_linedraw()
```

# Time Series 
```{r}
disch_tbl <- as_tsibble(swe_disch)
head(disch_tbl)
```
# Discharge Time Series
```{r}
disch_plot <- ggplot(swe_disch, aes(x = date, y = Q)) +
  geom_line(color = "darkblue") +
  labs(title = "Cache la Poudre River Streamflow",
       x = "Date", y = "Discharge (cfs)") +
  theme_minimal()
ggplotly(disch_plot)
```

# SWE Time Series
```{r}
swe_plot <- ggplot(swe_disch, aes(x = date, y = swe)) +
  geom_line(color = "darkblue") +
  labs(title = "Snow Water Equivalent",
       x = "Date", y = "Snow Water Equivalent") +
  theme_minimal()
ggplotly(swe_plot)
```

```{r}
library(patchwork)
disch_plot + swe_plot
```





